
{% extends "base.html" %}
{% load static %}

{% block extra_css %}
    {{ block.super }}
    <style>
    .lds-dual-ring {
      display: flex;
        justify-content: center;
        align-items: center;
    }
    .lds-dual-ring:after {
      content: " ";
      display: block;
      width: 64px;
      height: 64px;
      margin: 28px;
      border-radius: 50%;
      border: 6px solid #78cbf1;
      border-color: #646464 transparent #646464 transparent;
      animation: lds-dual-ring 1.2s linear infinite;
    }
    @keyframes lds-dual-ring {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
    </style>
    <!-- DataTables 1.x Core CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">
    <!-- Buttons Extension CSS (v2.x for DT1) -->
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">
    <!-- Select Extension CSS (v1.x for DT1) -->
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.7.0/css/select.dataTables.min.css">
    <!-- SearchBuilder Extension CSS (v1.x for DT1) -->
    <link rel="stylesheet" href="https://cdn.datatables.net/searchbuilder/1.6.0/css/searchBuilder.dataTables.min.css">
    <!-- SearchPanes Extension CSS (v2.x for DT1) -->
    <link rel="stylesheet" href="https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.dataTables.min.css">
{% endblock %}

{% block extra_js %}
    {{ block.super }}
    <!-- DataTables 1.x Core JS -->
    <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
    <!-- JSZip (required for Excel export) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- pdfmake (required for PDF export) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <!-- Buttons Extension JS (v2.x for DT1) -->
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.colVis.min.js"></script>
    <!-- Select Extension JS (v1.x for DT1) -->
    <script src="https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"></script>
    <!-- SearchBuilder Extension JS (v1.x for DT1) -->
    <script src="https://cdn.datatables.net/searchbuilder/1.6.0/js/dataTables.searchBuilder.min.js"></script>
    <!-- SearchPanes Extension JS (v2.x for DT1) -->
    <script src="https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js"></script>
    <!-- Plotly -->
    <script src='https://cdn.plot.ly/plotly-2.27.1.min.js'></script>
    <!-- Custom RYR2 JS -->
    <script type="text/javascript" src="{% static 'js/var_table_ryr2.js' %}"></script>
    <!-- Initialize Bootstrap tooltips -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function(el) {
                return new bootstrap.Tooltip(el);
            });
        });
    </script>
{% endblock %}

{% block page_content %}

<div align="center" class="text-center" style="margin-top: 30px">
    <h1>
        <p> <i>RYR2</i> Variant Browser </p>
    </h1>
</div>
<div>
    <p>
        Here we have a comprehensive list of variants in <i>RYR2</i> found in individuals affected and unaffected with the
        disease most commonly associated with variants in RYR2, catecholaminergic polymorphic ventricular tachycardia (CPVT; OMIM: 604772). Coding
        variants are referenced to isoform P21817 (ENST00000366574.7) to
        match convention. 'Total Carriers' is the number of heterozygotes diagnosed with CPVT or other disease,
        Unaffected with disease, and found in the genome aggregation database (gnomAD). 'Other' is the number of
        heterozygotes diagnosed with a cardiac disease which is not CPVT.
        Use the 'Search Builder' and 'Search Panes' to select subsets of variants based on properties you are interested in.
    </p>
</div>
<div class="lds-dual-ring" align="center"></div>
<table id="example" class="table table-striped table-bordered" style="display:none">
    <thead>
    <tr>
        <th>Ch.1 (grch38)</th>
        <th>Variant</th>
        <th>Residue Number</th>
        <th data-bs-toggle="tooltip" data-bs-placement="top" title="Number of heterozygous carriers diagnosed with Catecholaminergic Polymorphic Ventricular Tachycardia">CPVT</th>
        <th data-bs-toggle="tooltip" data-bs-placement="top" title="Total heterozygous carriers observed (CPVT + unaffected). Includes gnomAD population data, assumed unaffected given CPVT rarity.">Total Carriers</th>
        <th data-bs-toggle="tooltip" data-bs-placement="top" title="Known pathogenic hotspot region within RYR2">Hotspot</th>
        <th data-bs-toggle="tooltip" data-bs-placement="top" title="Bayesian posterior mean probability of CPVT diagnosis given heterozygosity">CPVT Penetrance(%)</th>
    </tr>
    </thead>
    <tbody>
    {% for sts in variants %}
    <tr>
        <td>{{ sts.grch38_pos }}</td>
        <td>{{ sts.var }}</td>
        <td>{{ sts.resnum }}</td>
        <th>{{ sts.cpvt }}</th>
        <td>{{ sts.total_carriers }}</td>
        <td>{{ sts.hotspot }}</td>
        <td>{% widthratio sts.p_mean_w 1 100 %}</td>
    </tr>
    {% endfor %}
   </tbody>
</table>

{% endblock %}
