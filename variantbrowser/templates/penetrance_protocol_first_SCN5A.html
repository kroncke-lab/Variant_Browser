{% extends "base.html" %}
{% load static %}
{% block page_content %}
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #cccccc; background-color: #303030; }
code > span.kw { color: #f0dfaf; } /* Keyword */
code > span.dt { color: #dfdfbf; } /* DataType */
code > span.dv { color: #dcdccc; } /* DecVal */
code > span.bn { color: #dca3a3; } /* BaseN */
code > span.fl { color: #c0bed1; } /* Float */
code > span.ch { color: #dca3a3; } /* Char */
code > span.st { color: #cc9393; } /* String */
code > span.co { color: #7f9f7f; } /* Comment */
code > span.ot { color: #efef8f; } /* Other */
code > span.al { color: #ffcfaf; } /* Alert */
code > span.fu { color: #efef8f; } /* Function */
code > span.er { color: #c3bf9f; } /* Error */
code > span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
code > span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code > span.sc { color: #dca3a3; } /* SpecialChar */
code > span.vs { color: #cc9393; } /* VerbatimString */
code > span.ss { color: #cc9393; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #f0dfaf; } /* ControlFlow */
code > span.op { color: #f0efd0; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #7f9f7f; } /* Documentation */
code > span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code > span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code > span.in { color: #7f9f7f; font-weight: bold; } /* Information */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type="text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




<div class="container-fluid main-container">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">SCN5A Penetrance Prediction</h1>
<h4 class="author">Brett Kroncke and Yi Zuo</h4>
<h4 class="date">June 30, 2020</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#data-preparation">Data preparation</a></li>
<li><a href="#em-algorithm">EM algorithm</a><ul>
<li><a href="#step-1-calculate-weighted-penetrance">Step 1 Calculate weighted penetrance</a></li>
<li><a href="#step-2-fit-beta-binomial-model-using-method-of-moments">Step 2 Fit Beta-Binomial model using method of moments</a></li>
<li><a href="#step-3-get-posterior-alpha_1i-and-beta_1i">Step 3 Get posterior <span class="math inline">\(\alpha_{1i}\)</span> and <span class="math inline">\(\beta_{1i}\)</span></a></li>
<li><a href="#step-4-get-posterior-mean-tildemu_i-and-variance-tildesigma2_i">Step 4 Get posterior mean <span class="math inline">\(\tilde\mu_i\)</span> and variance <span class="math inline">\(\tilde\sigma^2_i\)</span></a></li>
<li><a href="#step-5-calculate-penetrance-density-from-tildemu_i-using-function-funcdist">Step 5 Calculate penetrance density from <span class="math inline">\(\tilde\mu_i\)</span> using function <code>funcdist</code></a></li>
<li><a href="#step-6-fit-posterior-mean-tildemu_i-with-clinical-covariates">Step 6 Fit posterior mean <span class="math inline">\(\tilde\mu_i\)</span> with clinical covariates</a></li>
<li><a href="#step-7-use-fitted-penetrance-and-mse-from-step-6-to-solve-for-alpha-and-beta">Step 7 Use fitted penetrance and MSE from Step 6 to solve for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></a></li>
<li><a href="#step-8-calculate-convergence-criterion-delta-to-see-if-its-small-enough-to-end-the-loop">Step 8 Calculate convergence criterion <span class="math inline">\(\delta\)</span> to see if it’s small enough to end the loop</a></li>
</ul></li>
<li><a href="#results">Results</a><ul>
<li><a href="#part-1-coverage-plots">Part 1 Coverage plots</a><ul>
<li><a href="#bootstrap-and-get-the-coverage-rate">Bootstrap and get the coverage rate</a></li>
<li><a href="#bootstrap-function">Bootstrap function</a></li>
<li><a href="#plot-coverage">Plot coverage</a><ul>
<li><a href="#empirical-penetrance-as-the-true-penetrance">Empirical penetrance as the true penetrance</a></li>
<li><a href="#observed-penetrance-as-the-true-penetrance">Observed penetrance as the true penetrance</a></li>
</ul></li>
</ul></li>
<li><a href="#part-2-output-bland-altman-plots">Part 2 Output Bland-Altman plots</a><ul>
<li><a href="#em-prior-and-em-posterior">EM prior and EM posterior</a></li>
<li><a href="#em-prior-and-empirical-posterior">EM prior and empirical posterior</a></li>
<li><a href="#em-posterior-and-empirical-posterior">EM posterior and empirical posterior</a></li>
</ul></li>
<li><a href="#part-3-forest-plots">Part 3 Forest plots</a></li>
<li><a href="#part-4-correlation-coefficients-and-plots">Part 4 Correlation Coefficients and Plots</a><ul>
<li><a href="#expectation-maximization">Expectation Maximization</a><ul>
<li><a href="#peak-current-covariate-alone">Peak Current Covariate Alone</a></li>
<li><a href="#penetrance-density-covariate-alone">Penetrance Density Covariate Alone</a></li>
<li><a href="#peak-current-and-penetrance-density-covariates">Peak Current and Penetrance Density Covariates</a></li>
<li><a href="#in-silico-peak-current-and-penetrance-density-covariates">In Silico, Peak Current, and Penetrance Density Covariates</a></li>
<li><a href="#in-silico-covariates-alone">In Silico Covariates Alone</a></li>
</ul></li>
<li><a href="#empirical-bayes">Empirical Bayes</a><ul>
<li><a href="#penetrance-density-covariate-alone-1">Penetrance Density Covariate Alone</a></li>
<li><a href="#peak-current-and-penetrance-density-covariates-1">Peak Current and Penetrance Density Covariates</a></li>
<li><a href="#peak-current-and-penetrance-density-covariates-2">Peak Current and Penetrance Density Covariates</a></li>
<li><a href="#in-silico-covariates-alone-1">In Silico Covariates Alone</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="data-preparation" class="section level1">
<h1>Data preparation</h1>
<p>Data are cleaned and saved in <code>RData</code> format for the subsequent analyses.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 1: load the original data</span>
con =<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw">SQLite</span>(),
                <span class="dt">dbname=</span><span class="st">&quot;VariantSCN5A-third-revision.db&quot;</span>)
alltables =<span class="st"> </span><span class="kw">dbListTables</span>(con)
my.data &lt;-<span class="st"> </span><span class="kw">dbReadTable</span>(con, <span class="st">'VariantSCN5A'</span>)
my.data[my.data<span class="op">==</span><span class="st">'NA'</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
data&lt;-my.data
<span class="kw">dbDisconnect</span>(con)

<span class="kw">dim</span>(data) <span class="co"># 2417 by 29</span>
<span class="kw">names</span>(data)

<span class="co"># clean `resnum`</span>
<span class="kw">table</span>(data<span class="op">$</span>resnum)
<span class="kw">sum</span>(<span class="kw">is.na</span>(data<span class="op">$</span>resnum)) <span class="co"># 51 * + 1246 missing = 1297 abnormal</span>
<span class="kw">sum</span>(data<span class="op">$</span>resnum<span class="op">==</span><span class="st">&quot;&quot;</span>) <span class="co"># 1246 missing</span>

<span class="co"># convert strings to numeric values</span>
data<span class="op">$</span>resnum&lt;-<span class="kw">suppressWarnings</span>(<span class="kw">as.integer</span>(data<span class="op">$</span>resnum))
<span class="kw">sum</span>(<span class="kw">is.na</span>(data<span class="op">$</span>resnum)) <span class="co"># 1300 missing, three more </span>

<span class="co"># replace missing resnum with the number after the first capital letters?</span>
<span class="cf">for</span> (variant <span class="cf">in</span> data<span class="op">$</span>var){
  <span class="cf">if</span> (<span class="kw">is.na</span>(data[data<span class="op">$</span>var<span class="op">==</span>variant, <span class="st">&quot;resnum&quot;</span>])){
    <span class="kw">suppressWarnings</span>(data[data<span class="op">$</span>var<span class="op">==</span>variant, <span class="st">&quot;resnum&quot;</span>]&lt;-<span class="kw">as.integer</span>(<span class="kw">strsplit</span>(variant,<span class="st">&quot;[A-Z]&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]))
  }
}

<span class="kw">sum</span>(<span class="kw">is.na</span>(data<span class="op">$</span>resnum)) <span class="co"># 45 unsuccessful conversion</span>

data[<span class="kw">is.na</span>(data<span class="op">$</span>resnum),<span class="kw">c</span>(<span class="st">&quot;var&quot;</span>,<span class="st">&quot;resnum&quot;</span>)]

<span class="co"># manually get resnum from var among variants of interest</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;E444fsX14&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">444</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;F1775fsX1785&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1775</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;L1579fsX53&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1579</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.1795insD&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1795</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.G1031fsX27&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1031</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.G1748del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1748</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.G1758del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1758</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.L1339del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1339</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.M741_T742delinsI &quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">741</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;Y1795insD&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1795</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.A586_L587del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">586</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.A586_L587del&quot;</span>,<span class="st">&quot;lqt3&quot;</span>]&lt;-<span class="dv">1</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.A586_L587del&quot;</span>,<span class="st">&quot;var&quot;</span>]&lt;-<span class="st">&quot;p.586_587delAL&quot;</span>
data&lt;-data[data<span class="op">$</span>var<span class="op">!=</span><span class="st">&quot;p.A586_L587del&quot;</span>,]
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.E1939_E1943del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1939</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.E1072del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1072</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.E1064del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1064</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.F1465_L1480dup&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1465</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.M1875dup&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1875</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.N507_L515dup&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">507</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.N291_S293dup&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">291</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.Pro2006del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">2006</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.Gln1000del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1000</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.S1970_S1972del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1970</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.T290_G292del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">290</span>
data[data<span class="op">$</span>var<span class="op">==</span><span class="st">&quot;p.I1758del&quot;</span>,<span class="st">&quot;resnum&quot;</span>]&lt;-<span class="dv">1758</span>


data[<span class="kw">is.na</span>(data<span class="op">$</span>resnum),<span class="kw">c</span>(<span class="st">&quot;var&quot;</span>,<span class="st">&quot;resnum&quot;</span>)]

<span class="co"># after the conversion, how many missing in resnum?</span>
<span class="kw">sum</span>(<span class="kw">is.na</span>(data<span class="op">$</span>resnum)) <span class="co"># 23</span>

<span class="co"># are resnum unique? No</span>
<span class="kw">length</span>(<span class="kw">unique</span>(data<span class="op">$</span>resnum))

<span class="co"># are nativeAA and mutAA different when resnum is the same?</span>
duplicates &lt;-<span class="st"> </span>data[<span class="kw">duplicated</span>(data<span class="op">$</span>resnum)<span class="op">|</span><span class="kw">duplicated</span>(data<span class="op">$</span>resnum,<span class="dt">fromLast =</span> T),<span class="kw">c</span>(<span class="st">&quot;var&quot;</span>,<span class="st">&quot;resnum&quot;</span>,<span class="st">&quot;nativeAA&quot;</span>,<span class="st">&quot;mutAA&quot;</span>)]

<span class="co"># it appears so  </span>
<span class="kw">head</span>(duplicates[<span class="kw">order</span>(duplicates<span class="op">$</span>resnum),])

<span class="co"># nativeAA</span>
<span class="kw">table</span>(data<span class="op">$</span>nativeAA)
<span class="kw">sum</span>(<span class="kw">is.na</span>(data<span class="op">$</span>nativeAA)) <span class="co"># 168 missing</span>

<span class="co"># mutAA</span>
<span class="kw">table</span>(data<span class="op">$</span>mutAA)
<span class="kw">sum</span>(<span class="kw">is.na</span>(data<span class="op">$</span>mutAA)) <span class="co"># 168 missing</span>

<span class="co"># create a composite index for merging</span>
data<span class="op">$</span>res_nm &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">as.character</span>(data<span class="op">$</span>resnum),data<span class="op">$</span>nativeAA,data<span class="op">$</span>mutAA)

<span class="co"># Step 2: load five supplementary data</span>
<span class="co"># load data</span>
bcl  &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;covariates/scn5a_bcl_features.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)
sasa &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;covariates/5a_5x0m_sasa.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
pph2&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;covariates/pph2-20180329.csv&quot;</span>, <span class="dt">strip.white =</span> <span class="ot">TRUE</span>)
prov&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;covariates/provean_revised.csv&quot;</span>, <span class="dt">strip.white =</span> <span class="ot">TRUE</span>)
pam &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;covariates/sin_pam_energy_funcdist.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)

<span class="co"># Step 3: examine supplementary data</span>
<span class="co"># pam</span>
<span class="co"># pam has the same covariates as in the original data</span>
<span class="kw">sum</span>(<span class="kw">names</span>(pam)<span class="op">%in%</span><span class="kw">names</span>(data)) <span class="op">==</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">names</span>(pam))
<span class="co"># seven times duplicated observations</span>
<span class="kw">nrow</span>(pam) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(<span class="kw">unique</span>(pam))
pam.u &lt;-<span class="st"> </span><span class="kw">unique</span>(pam)
<span class="kw">head</span>(pam.u)
data[data<span class="op">$</span>var <span class="op">==</span><span class="st"> &quot;A2T&quot;</span>,<span class="st">&quot;pamscore&quot;</span>]
<span class="co"># no need to merge with pam</span>

<span class="co"># pph2 </span>
<span class="kw">dim</span>(pph2)
<span class="co"># all unique</span>
<span class="kw">dim</span>(<span class="kw">unique</span>(pph2))
<span class="co"># contains four more covariates but no `var`</span>
<span class="kw">sum</span>(<span class="kw">names</span>(pph2)<span class="op">%in%</span><span class="kw">names</span>(data)) <span class="op">==</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">names</span>(pph2))
<span class="kw">names</span>(pph2)<span class="op">%in%</span><span class="kw">names</span>(data)
<span class="kw">names</span>(pph2)
<span class="kw">head</span>(pph2)
<span class="co"># each residue number has 19 rows</span>
<span class="kw">length</span>(<span class="kw">unique</span>(pph2<span class="op">$</span>resnum))
pph2[pph2<span class="op">$</span>resnum<span class="op">==</span><span class="dv">1</span>,]
<span class="kw">table</span>(data<span class="op">$</span>resnum)
<span class="co"># create a composite index for merging</span>
pph2<span class="op">$</span>res_nm &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">as.character</span>(pph2<span class="op">$</span>resnum),pph2<span class="op">$</span>nativeAA,pph2<span class="op">$</span>mutAA)

<span class="co"># sasa</span>
<span class="kw">dim</span>(sasa)
<span class="co"># all unique</span>
<span class="kw">dim</span>(<span class="kw">unique</span>(sasa))
<span class="kw">head</span>(sasa)
<span class="co"># unique resnum</span>
<span class="kw">length</span>(<span class="kw">unique</span>(sasa<span class="op">$</span>resnum)) <span class="op">==</span><span class="st"> </span><span class="kw">nrow</span>(sasa)

<span class="co"># bcl</span>
<span class="kw">dim</span>(bcl)
<span class="co"># eight duplicates</span>
<span class="kw">dim</span>(<span class="kw">unique</span>(bcl))
<span class="kw">head</span>(bcl)
bcl[<span class="kw">duplicated</span>(bcl),]
bcl &lt;-<span class="st"> </span><span class="kw">distinct</span>(bcl)
<span class="kw">dim</span>(bcl)
<span class="co"># no duplicates</span>
<span class="kw">dim</span>(<span class="kw">unique</span>(bcl))
<span class="kw">head</span>(bcl)

<span class="co"># prov</span>
<span class="kw">dim</span>(prov)
<span class="kw">dim</span>(<span class="kw">unique</span>(prov))
<span class="co"># 15 duplicates</span>
prov &lt;-<span class="st"> </span><span class="kw">distinct</span>(prov)
<span class="kw">dim</span>(<span class="kw">unique</span>(prov))[<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span><span class="kw">nrow</span>(prov)
<span class="kw">head</span>(prov)
<span class="co"># create a composite index for merging</span>
prov<span class="op">$</span>res_nm &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">as.character</span>(prov<span class="op">$</span>resnum),prov<span class="op">$</span>nativeAA,prov<span class="op">$</span>mutAA)


<span class="co"># Step 4: merge data with 4 additional data sets</span>
<span class="co"># pph</span>
data.pph &lt;-<span class="st"> </span><span class="kw">merge</span>(data,pph2,<span class="dt">by=</span><span class="st">&quot;res_nm&quot;</span>,<span class="dt">all.x=</span>T)
<span class="kw">dim</span>(data.pph)
<span class="co"># drop the resnum, mutAA, nativeAA from pph2</span>
data.pph&lt;-data.pph[,<span class="op">-</span><span class="kw">which</span>(<span class="kw">names</span>(data.pph) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;resnum.y&quot;</span>,<span class="st">&quot;mutAA.y&quot;</span>,<span class="st">&quot;nativeAA.y&quot;</span>))]

<span class="co"># rename resnum</span>
<span class="kw">colnames</span>(data.pph)[<span class="kw">colnames</span>(data.pph)<span class="op">==</span><span class="st">&quot;resnum.x&quot;</span>] &lt;-<span class="st"> &quot;resnum&quot;</span>
<span class="kw">colnames</span>(data.pph)[<span class="kw">colnames</span>(data.pph)<span class="op">==</span><span class="st">&quot;mutAA.x&quot;</span>] &lt;-<span class="st"> &quot;mutAA&quot;</span>
<span class="kw">colnames</span>(data.pph)[<span class="kw">colnames</span>(data.pph)<span class="op">==</span><span class="st">&quot;nativeAA.x&quot;</span>] &lt;-<span class="st"> &quot;nativeAA&quot;</span>
<span class="kw">names</span>(data.pph)

<span class="co"># sasa</span>
data.pph.sasa &lt;-<span class="st"> </span><span class="kw">merge</span>(data.pph,sasa,<span class="dt">by=</span><span class="st">&quot;resnum&quot;</span>,<span class="dt">all.x=</span>T)
<span class="kw">dim</span>(data.pph.sasa)
<span class="kw">colnames</span>(data.pph.sasa)

<span class="co"># bcl</span>
data.pph.sasa.bcl &lt;-<span class="st"> </span><span class="kw">merge</span>(data.pph.sasa,bcl,<span class="dt">by=</span><span class="st">&quot;var&quot;</span>,<span class="dt">all.x=</span>T)
<span class="kw">dim</span>(data.pph.sasa.bcl)
<span class="kw">names</span>(data.pph.sasa.bcl)

<span class="co"># prov</span>
data.pph.sasa.bcl.prov &lt;-<span class="st"> </span><span class="kw">merge</span>(data.pph.sasa.bcl,prov,<span class="dt">by=</span><span class="st">&quot;res_nm&quot;</span>,<span class="dt">all.x =</span> T)
<span class="kw">dim</span>(data.pph.sasa.bcl.prov)
<span class="kw">names</span>(data.pph.sasa.bcl.prov)

<span class="co"># drop the resnum, mutAA, nativeAA from prov</span>
data.pph.sasa.bcl.prov&lt;-data.pph.sasa.bcl.prov[,<span class="op">-</span><span class="kw">which</span>(<span class="kw">names</span>(data.pph.sasa.bcl.prov) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;resnum.y&quot;</span>,<span class="st">&quot;mutAA.y&quot;</span>,<span class="st">&quot;nativeAA.y&quot;</span>))]

<span class="co"># rename resnum</span>
<span class="kw">colnames</span>(data.pph.sasa.bcl.prov)[<span class="kw">colnames</span>(data.pph.sasa.bcl.prov)<span class="op">==</span><span class="st">&quot;resnum.x&quot;</span>] &lt;-<span class="st"> &quot;resnum&quot;</span>
<span class="kw">colnames</span>(data.pph.sasa.bcl.prov)[<span class="kw">colnames</span>(data.pph.sasa.bcl.prov)<span class="op">==</span><span class="st">&quot;mutAA.x&quot;</span>] &lt;-<span class="st"> &quot;mutAA&quot;</span>
<span class="kw">colnames</span>(data.pph.sasa.bcl.prov)[<span class="kw">colnames</span>(data.pph.sasa.bcl.prov)<span class="op">==</span><span class="st">&quot;nativeAA.x&quot;</span>] &lt;-<span class="st"> &quot;nativeAA&quot;</span>
<span class="kw">names</span>(data.pph.sasa.bcl.prov)
<span class="kw">dim</span>(data.pph.sasa.bcl.prov)
<span class="kw">head</span>(data.pph.sasa.bcl.prov)
mydata &lt;-<span class="st"> </span>data.pph.sasa.bcl.prov

<span class="co"># Step 5: exclusion criteria</span>
<span class="co"># drop zero total carriers</span>

mydata<span class="op">$</span>gnomAD&lt;-<span class="kw">as.integer</span>(mydata<span class="op">$</span>gnomAD)
<span class="kw">sum</span>(<span class="kw">is.na</span>(mydata<span class="op">$</span>gnomAD))
mydata<span class="op">$</span>gnomAD[<span class="kw">is.na</span>(mydata<span class="op">$</span>gnomAD)] &lt;-<span class="st"> </span><span class="dv">0</span>

mydata<span class="op">$</span>total_carriers&lt;-mydata<span class="op">$</span>unaff<span class="op">+</span>mydata<span class="op">$</span>lqt3<span class="op">+</span>mydata<span class="op">$</span>brs1<span class="op">+</span>mydata<span class="op">$</span>gnomAD
mydata.total&lt;-mydata[mydata<span class="op">$</span>total_carriers<span class="op">&gt;</span><span class="dv">0</span>, ]
<span class="kw">dim</span>(mydata.total)
<span class="kw">names</span>(mydata.total)

<span class="co"># keep only missense, aadel and aains mututation types</span>
mydata.total &lt;-<span class="st"> </span>mydata.total[mydata.total<span class="op">$</span>mut_type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;missense&quot;</span>,<span class="st">&quot;aadel&quot;</span>, <span class="st">&quot;aains&quot;</span>),]
<span class="kw">dim</span>(mydata.total)

<span class="co"># rename the final data set without clinical covariates</span>
d &lt;-<span class="st"> </span>mydata.total
d&lt;-d[,<span class="op">!</span>(<span class="kw">names</span>(d) <span class="op">%in%</span><span class="st"> &quot;aaneigh_rank_inc_loops&quot;</span>)]
d&lt;-d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>resnum),]
<span class="kw">dim</span>(d)
<span class="kw">names</span>(d)
<span class="kw">save</span>(d,<span class="dt">file=</span><span class="st">&quot;BrS1_data.RData&quot;</span>)</code></pre></div>
</div>
<div id="em-algorithm" class="section level1">
<h1>EM algorithm</h1>
<div id="step-1-calculate-weighted-penetrance" class="section level2">
<h2>Step 1 Calculate weighted penetrance</h2>
<p>The weighted penetrance is</p>
<p><span class="math display">\[\bar p_w=\frac{\sum_{i=1}^m w_i \hat p_i}{\sum_{i=1}^m w_i} \]</span></p>
<p>where the weight is</p>
<p><span class="math display">\[w_i=1-\frac{1}{0.01+n_i} \]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;BrS1_data.RData&quot;</span>)
<span class="co"># Step 1: Calculate overall penetrance and weighted penetrance  </span>

<span class="co"># observed penetrance for each variant</span>
d<span class="op">$</span>p_observed &lt;-<span class="st"> </span>d<span class="op">$</span>lqt3<span class="op">/</span>d<span class="op">$</span>total_carriers 

<span class="co"># overall penetrance </span>
p_bar &lt;-<span class="st"> </span><span class="kw">sum</span>(d<span class="op">$</span>brs1)<span class="op">/</span><span class="kw">sum</span>(d<span class="op">$</span>total_carriers)

<span class="co"># weighted penetrance</span>
wp &lt;-<span class="st"> </span><span class="cf">function</span>(p_observed,weight){
  <span class="kw">sum</span>(weight<span class="op">*</span>p_observed)<span class="op">/</span><span class="kw">sum</span>(weight)
}

<span class="co"># weighted penetrance </span>
w &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="fl">0.01</span><span class="op">+</span>d<span class="op">$</span>total_carriers)
p_w &lt;-<span class="st"> </span><span class="kw">wp</span>(d<span class="op">$</span>p_observed, w)</code></pre></div>
<p><a href="#top">Back to top</a></p>
</div>
<div id="step-2-fit-beta-binomial-model-using-method-of-moments" class="section level2">
<h2>Step 2 Fit Beta-Binomial model using method of moments</h2>
<p>Variants have common prior</p>
<p><span class="math display">\[\hat p_i\sim Beta(\alpha_0,\beta_0) \]</span></p>
<p>The mean and variance of Beta distribution is</p>
<p><span class="math display">\[E(\hat p_i)=\bar p_w,\: Var(\hat p_i)=\text{MSE from weighted regression} \]</span> We can solve for <span class="math inline">\(\alpha_0\)</span> and <span class="math inline">\(\beta_0\)</span> using method of moments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># solve for alpha and beta in Beta distribution</span>
solab &lt;-<span class="st"> </span><span class="cf">function</span>(mean, variance){
  alpha &lt;-<span class="st"> </span>(mean<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>mean) <span class="op">-</span><span class="st"> </span>variance <span class="op">*</span><span class="st"> </span>mean)<span class="op">/</span>variance
  beta &lt;-<span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mean <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)
  <span class="kw">return</span>(<span class="kw">c</span>(alpha,beta))
}

d<span class="op">$</span>w &lt;-<span class="st"> </span>w

<span class="co"># variance for weighted penetrance</span>
vwp &lt;-<span class="st"> </span><span class="cf">function</span>(weight){
  lm &lt;-<span class="st"> </span><span class="kw">lm</span>(p_observed<span class="op">~</span><span class="dv">1</span>,<span class="dt">data=</span>d,<span class="dt">weights=</span>weight)
  <span class="kw">mean</span>((lm<span class="op">$</span>residuals)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(lm<span class="op">$</span>weights))
}

<span class="co"># weighted using weight 2</span>
alpha_0_w &lt;-<span class="st"> </span><span class="kw">solab</span>(p_w, <span class="kw">vwp</span>(w))[<span class="dv">1</span>]
beta_0_w &lt;-<span class="st"> </span><span class="kw">solab</span>(p_w, <span class="kw">vwp</span>(w))[<span class="dv">2</span>]

<span class="co"># create empirical penetrance from alpha_0 and beta_0</span>
d<span class="op">$</span>p_empirical &lt;-<span class="st"> </span>(d<span class="op">$</span>brs1 <span class="op">+</span><span class="st"> </span>alpha_0_w)<span class="op">/</span>(d<span class="op">$</span>total_carriers<span class="op">+</span>alpha_0_w<span class="op">+</span>beta_0_w)</code></pre></div>
<p><a href="#top">Back to top</a></p>
</div>
<div id="step-3-get-posterior-alpha_1i-and-beta_1i" class="section level2">
<h2>Step 3 Get posterior <span class="math inline">\(\alpha_{1i}\)</span> and <span class="math inline">\(\beta_{1i}\)</span></h2>
<p>Variant-specific Beta-Binomial posterior <span class="math inline">\(\alpha_{1i}\)</span> and <span class="math inline">\(\beta_{1i}\)</span> based on Beta prior</p>
<p><span class="math display">\[\alpha_{1i}=\alpha_0+x_i,\beta_{1i}=\beta_0+n_i-x_i \]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># function for deriving posterior alpha and beta</span>
pab &lt;-<span class="st"> </span><span class="cf">function</span>(alpha,beta,x,n){
  alpha_<span class="dv">1</span> &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>x
  beta_<span class="dv">1</span> &lt;-<span class="st"> </span>beta <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>x
  <span class="kw">return</span>(<span class="kw">cbind</span>(alpha_<span class="dv">1</span>,beta_<span class="dv">1</span>))
}

alpha_1_w &lt;-<span class="st"> </span><span class="kw">pab</span>(alpha_0_w,beta_0_w,d<span class="op">$</span>brs1,d<span class="op">$</span>total_carriers)[,<span class="dv">1</span>]
beta_1_w &lt;-<span class="st"> </span><span class="kw">pab</span>(alpha_0_w,beta_0_w,d<span class="op">$</span>brs1,d<span class="op">$</span>total_carriers)[,<span class="dv">2</span>]</code></pre></div>
<p><a href="#top">Back to top</a></p>
</div>
<div id="step-4-get-posterior-mean-tildemu_i-and-variance-tildesigma2_i" class="section level2">
<h2>Step 4 Get posterior mean <span class="math inline">\(\tilde\mu_i\)</span> and variance <span class="math inline">\(\tilde\sigma^2_i\)</span></h2>
<p>The mean <span class="math inline">\(\tilde\mu_i\)</span> of posterior distribution is</p>
<p><span class="math display">\[\tilde \mu_i=\frac{\alpha_{1i}}{\alpha_{1i}+\beta_{1i}} \]</span></p>
<p>The variance <span class="math inline">\(\tilde\sigma^2_i\)</span> of posterior distribution is</p>
<p><span class="math display">\[\tilde\sigma^2_i=\frac{\alpha_{1i}\beta_{1i}}{(\alpha_{1i}+\beta_{1i})^2(\alpha_{1i}+\beta_{1i}+1)} \]</span></p>
<p>which is raised at 20th percentile.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pmv &lt;-<span class="st"> </span><span class="cf">function</span>(alpha,beta){
  mean &lt;-<span class="st"> </span>alpha<span class="op">/</span>(alpha<span class="op">+</span>beta)
  variance &lt;-<span class="st"> </span>alpha<span class="op">*</span>beta<span class="op">/</span>(alpha<span class="op">+</span>beta)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(alpha<span class="op">+</span>beta<span class="op">+</span><span class="dv">1</span>)
  <span class="kw">return</span>(<span class="kw">cbind</span>(mean,variance))
}

p_mean_w &lt;-<span class="st"> </span><span class="kw">pmv</span>(alpha_1_w,beta_1_w)[,<span class="dv">1</span>]
p_variance_w &lt;-<span class="st"> </span><span class="kw">pmv</span>(alpha_1_w,beta_1_w)[,<span class="dv">2</span>]
p_variance_w[p_variance_w<span class="op">&lt;</span><span class="kw">quantile</span>(p_variance_w,<span class="fl">0.2</span>)] &lt;-<span class="st"> </span><span class="kw">quantile</span>(p_variance_w,<span class="fl">0.2</span>)
d<span class="op">$</span>p_variance_w &lt;-<span class="st"> </span>p_variance_w</code></pre></div>
<p><a href="#top">Back to top</a></p>
</div>
<div id="step-5-calculate-penetrance-density-from-tildemu_i-using-function-funcdist" class="section level2">
<h2>Step 5 Calculate penetrance density from <span class="math inline">\(\tilde\mu_i\)</span> using function <code>funcdist</code></h2>
<p>Note that only 774 out of 1439 (53.8%) variants fall within structured regions of the protein.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">index &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">length</span>(d<span class="op">$</span>resnum),<span class="dv">1</span>)

d<span class="op">$</span>p_mean_w &lt;-<span class="st"> </span>p_mean_w

w_results &lt;-<span class="st"> </span><span class="kw">sapply</span>(index,<span class="cf">function</span>(x) <span class="kw">funcdist</span>(d[x, <span class="st">&quot;resnum&quot;</span>], d[x, <span class="st">&quot;var&quot;</span>], d, distances, <span class="st">&quot;p_mean_w&quot;</span>, <span class="st">&quot;sigmoid&quot;</span>, <span class="dv">7</span>))

<span class="co"># dim(w_results)</span>

d<span class="op">$</span>feat_dist_w_ &lt;-<span class="st"> </span><span class="ot">NULL</span>
d[index,<span class="st">&quot;feat_dist_w&quot;</span>] &lt;-<span class="st"> </span>w_results[<span class="dv">1</span>,]
d<span class="op">$</span>feat_dist_weight_w &lt;-<span class="st"> </span><span class="ot">NULL</span>
d[index,<span class="st">&quot;feat_dist_weight_w&quot;</span>] &lt;-<span class="st"> </span>w_results[<span class="dv">2</span>,]</code></pre></div>
<p><a href="#top">Back to top</a></p>
</div>
<div id="step-6-fit-posterior-mean-tildemu_i-with-clinical-covariates" class="section level2">
<h2>Step 6 Fit posterior mean <span class="math inline">\(\tilde\mu_i\)</span> with clinical covariates</h2>
<p>The clinical covariates include <code>eaRate</code>, <code>blastpssm</code>, <code>provean_score</code>, <code>pph2_prob</code>, <code>ipeak</code>, and penetrance density.</p>
<p>Here pattern mixture model is used.</p>
<p><a href="#top">Back to top</a></p>
</div>
<div id="step-7-use-fitted-penetrance-and-mse-from-step-6-to-solve-for-alpha-and-beta" class="section level2">
<h2>Step 7 Use fitted penetrance and MSE from Step 6 to solve for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></h2>
<p>Adjust <span class="math inline">\(\alpha_{fi}\)</span> and <span class="math inline">\(\beta_{fi}\)</span> to <span class="math inline">\(\alpha_0\)</span> and <span class="math inline">\(\beta_0\)</span> if they were too small (&lt;0.01)</p>
<p><a href="#top">Back to top</a></p>
</div>
<div id="step-8-calculate-convergence-criterion-delta-to-see-if-its-small-enough-to-end-the-loop" class="section level2">
<h2>Step 8 Calculate convergence criterion <span class="math inline">\(\delta\)</span> to see if it’s small enough to end the loop</h2>
<p>Calculate the convergence criterion <span class="math inline">\(\delta\)</span> as follows, and if it’s greater than 0.1, then repeat Step 6 to Step 8. When <span class="math inline">\(\delta\)</span> is smaller than 0.1, EM converges.</p>
<p><span class="math display">\[\delta=\sum_{i=1}^m |p^{em+}_i-p^{em-}_i| \]</span></p>
<p>where <span class="math inline">\(p_i^{em+}\)</span> is the penetrance after one iteration of EM alogrithm for each variant, and <span class="math inline">\(p_i^{em-}\)</span> is the penetrance from the previous iteration of EM alogrithm for each variant.</p>
<p>EM algorithm converges in 7 steps.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">delta &lt;-<span class="st"> </span><span class="dv">10</span>

d<span class="op">$</span>eaRate &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(d<span class="op">$</span>eaRate)
d<span class="op">$</span>blastpssm &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(d<span class="op">$</span>blastpssm)
d<span class="op">$</span>ipeak &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">as.numeric</span>(d<span class="op">$</span>ipeak))

covariates &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;eaRate&quot;</span>,<span class="st">&quot;blastpssm&quot;</span>,<span class="st">&quot;provean_score&quot;</span>,<span class="st">&quot;pph2_prob&quot;</span>,<span class="st">&quot;ipeak&quot;</span>,<span class="st">&quot;feat_dist_w&quot;</span>)

<span class="co"># weight for weighted regression</span>
d<span class="op">$</span>weight_r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>p_variance_w

d<span class="op">$</span>alpha_1_w &lt;-<span class="st"> </span>alpha_1_w
d<span class="op">$</span>beta_1_w &lt;-<span class="st"> </span>beta_1_w
d<span class="op">$</span>p_mean_w &lt;-<span class="st"> </span>p_mean_w

regression &lt;-<span class="st"> </span><span class="cf">function</span>(dv, pivs, nivs, data) {
  <span class="co"># run a linear model with text arguments for dv and ivs</span>
  piv_string &lt;-<span class="st"> </span><span class="kw">paste</span>(pivs, <span class="dt">collapse=</span><span class="st">&quot; + &quot;</span>)
  niv_string &lt;-<span class="st"> </span><span class="kw">paste</span>(nivs, <span class="dt">collapse=</span><span class="st">&quot; - &quot;</span>)
  <span class="cf">if</span>(niv_string<span class="op">!=</span><span class="st">&quot;&quot;</span>) iv_string &lt;-<span class="st"> </span><span class="kw">paste</span>(piv_string, <span class="st">&quot; - &quot;</span>, niv_string, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  <span class="cf">if</span>(niv_string<span class="op">==</span><span class="st">&quot;&quot;</span>) iv_string &lt;-<span class="st"> </span><span class="kw">paste</span>(piv_string)
  <span class="co">#print(iv_string)</span>
  regression_formula &lt;-<span class="st"> </span><span class="kw">as.formula</span>(<span class="kw">paste</span>(dv, iv_string, <span class="dt">sep=</span><span class="st">&quot; ~ &quot;</span>))
  <span class="co">#print(regression_formula)</span>
  <span class="kw">lm</span>(regression_formula, data, <span class="dt">weights =</span> d<span class="op">$</span>weight_r)
}

count &lt;-<span class="st"> </span><span class="dv">0</span>

<span class="cf">while</span>(delta<span class="op">&gt;</span><span class="fl">0.1</span> <span class="op">&amp;</span><span class="st"> </span>count <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>){
  
  count &lt;-<span class="st"> </span>count <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  alpha_f &lt;-<span class="st"> </span><span class="ot">NULL</span>
  beta_f &lt;-<span class="st"> </span><span class="ot">NULL</span>
  
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(d)){
  newdata =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">var=</span>d[i,<span class="st">&quot;var&quot;</span>])
  newdata[covariates] &lt;-<span class="st"> </span>d[i,covariates]
  model &lt;-<span class="st"> </span><span class="kw">regression</span>(<span class="st">&quot;p_mean_w&quot;</span>, covariates, 
                      <span class="kw">colnames</span>(newdata)[<span class="kw">colSums</span>(<span class="kw">is.na</span>(newdata))<span class="op">&gt;</span><span class="dv">0</span>], d)
  mean_f &lt;-<span class="st"> </span><span class="kw">predict</span>(model, newdata)
  variance_f &lt;-<span class="st"> </span>(<span class="kw">predict</span>(model, newdata,<span class="dt">se.fit =</span> T)<span class="op">$</span>se.fit)<span class="op">^</span><span class="dv">2</span>
  alpha &lt;-<span class="st"> </span><span class="kw">solab</span>(mean_f,variance_f)[<span class="dv">1</span>]
  beta &lt;-<span class="st"> </span><span class="kw">solab</span>(mean_f,variance_f)[<span class="dv">2</span>]
  <span class="cf">if</span>(alpha<span class="op">&lt;</span><span class="fl">0.01</span> <span class="op">|</span><span class="st"> </span>beta<span class="op">&lt;</span><span class="fl">0.01</span>){
    alpha_f[i]=alpha_0_w
    beta_f[i]=beta_0_w
  }<span class="cf">else</span>{
    alpha_f[i]=alpha
    beta_f[i]=beta
  }
  }
  
  new_mean &lt;-<span class="st"> </span>(alpha_f <span class="op">+</span><span class="st"> </span>d<span class="op">$</span>brs1)<span class="op">/</span>(alpha_f <span class="op">+</span><span class="st"> </span>beta_f <span class="op">+</span><span class="st"> </span>d<span class="op">$</span>total_carriers)
  
  delta &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(new_mean<span class="op">-</span>d<span class="op">$</span>p_mean_w))
  
  d<span class="op">$</span>p_mean_w &lt;-<span class="st"> </span>new_mean

}</code></pre></div>
<p><a href="#top">Back to top</a></p>
<p>Scale the variance by a factor of 20, add function and structure annotations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># update alpha and beta</span>

<span class="co"># when tuning parameter is 20</span>
mean &lt;-<span class="st"> </span>alpha_f<span class="op">/</span>(alpha_f<span class="op">+</span>beta_f)
variance &lt;-<span class="st"> </span>mean<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>mean)
variance &lt;-<span class="st"> </span>variance <span class="op">/</span><span class="st"> </span><span class="dv">20</span>

alpha_g &lt;-<span class="st"> </span>(mean<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>mean) <span class="op">-</span><span class="st"> </span>variance <span class="op">*</span><span class="st"> </span>mean) <span class="op">/</span>variance
beta_g &lt;-<span class="st"> </span>alpha_g <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mean <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># save data</span>
d<span class="op">$</span>alpha_g &lt;-<span class="st"> </span>alpha_g
d<span class="op">$</span>beta_g &lt;-<span class="st"> </span>beta_g

<span class="co"># update brs1/lqt3 penetrance posterior estimates</span>
d<span class="op">$</span>brs1_penetrance&lt;-(d<span class="op">$</span>alpha_g<span class="op">+</span>d<span class="op">$</span>brs1)<span class="op">/</span>(d<span class="op">$</span>total_carriers<span class="op">+</span>d<span class="op">$</span>beta_g<span class="op">+</span>d<span class="op">$</span>alpha_g)
d<span class="op">$</span>lqt3_penetrance&lt;-(<span class="fl">0.366</span><span class="op">+</span>d<span class="op">$</span>lqt3)<span class="op">/</span>(d<span class="op">$</span>total_carriers<span class="op">+</span><span class="fl">0.366</span><span class="op">+</span><span class="fl">2.88</span>)

<span class="co"># annotate functional perturbation</span>
d<span class="op">$</span>Function&lt;-<span class="ot">NA</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>ipeak) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ipeak<span class="op">&lt;</span><span class="fl">0.1</span>,<span class="st">&quot;Function&quot;</span>]&lt;-<span class="st">&quot;LOF&quot;</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>ipeak) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ipeak<span class="op">&lt;</span><span class="fl">0.5</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ipeak<span class="op">&gt;=</span><span class="fl">0.1</span>,<span class="st">&quot;Function&quot;</span>]&lt;-<span class="st">&quot;Partial_LOF&quot;</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>ipeak) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ipeak<span class="op">&gt;=</span><span class="fl">0.5</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ipeak<span class="op">&lt;</span><span class="fl">0.75</span>,<span class="st">&quot;Function&quot;</span>]&lt;-<span class="st">&quot;Mild_LOF&quot;</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>ipeak) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ipeak<span class="op">&gt;=</span><span class="fl">0.75</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ipeak<span class="op">&lt;</span><span class="fl">1.25</span>,<span class="st">&quot;Function&quot;</span>]&lt;-<span class="st">&quot;Normal&quot;</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>ipeak) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ipeak<span class="op">&gt;=</span><span class="fl">1.25</span>,<span class="st">&quot;Function&quot;</span>]&lt;-<span class="st">&quot;GOF&quot;</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>vhalfact) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>vhalfact<span class="op">&gt;</span><span class="dv">10</span>,<span class="st">&quot;Function&quot;</span>]&lt;-<span class="st">&quot;Partial_LOF&quot;</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>ilate) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>ilate<span class="op">&gt;=</span><span class="dv">3</span>,<span class="st">&quot;Function&quot;</span>]&lt;-<span class="st">&quot;GOF&quot;</span>

<span class="co"># annotate structural location (hotspot) </span>
d<span class="op">$</span>Structure&lt;-<span class="ot">NA</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>feat_dist_w) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>feat_dist_w<span class="op">&lt;</span><span class="fl">0.1</span>,<span class="st">&quot;Structure&quot;</span>]&lt;-<span class="st">&quot;Non_Hotspot&quot;</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>feat_dist_w) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>feat_dist_w<span class="op">&gt;=</span><span class="fl">0.1</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>feat_dist_w<span class="op">&lt;</span><span class="fl">0.4</span>,<span class="st">&quot;Structure&quot;</span>]&lt;-<span class="st">&quot;Mild_Hotspot&quot;</span>
d[<span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>feat_dist_w) <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>feat_dist_w<span class="op">&gt;=</span><span class="fl">0.4</span>,<span class="st">&quot;Structure&quot;</span>]&lt;-<span class="st">&quot;Hotspot&quot;</span>

<span class="kw">save</span>(d,<span class="dt">file=</span><span class="st">&quot;CheckPoint_20.RData&quot;</span>)</code></pre></div>
</div>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<div id="part-1-coverage-plots" class="section level2">
<h2>Part 1 Coverage plots</h2>
<div id="bootstrap-and-get-the-coverage-rate" class="section level3">
<h3>Bootstrap and get the coverage rate</h3>
<ol style="list-style-type: decimal">
<li><p>Use the observed penetrance from some variant as the TRUE penetrance for that variant, generate n binomial observations</p></li>
<li><p>Use the final EM algorithm posterior as the prior for Beta-Binomial, incorporate data from previous step, generate the posterior distribution, get 95% credible interval.</p></li>
<li><p>Check whether the interval cover the true penetrance from Step 1.</p></li>
<li><p>Repeat Step 1 to Step 3 N times to get the coverage rate.</p></li>
</ol>
</div>
<div id="bootstrap-function" class="section level3">
<h3>Bootstrap function</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">BootsCoverage &lt;-<span class="st"> </span><span class="cf">function</span>(var,<span class="dt">n=</span><span class="dv">100</span>,<span class="dt">N=</span><span class="dv">1000</span>,true){
  
  <span class="co"># var: variant name</span>
  <span class="co"># n: number of subjects in the new data</span>
  <span class="co"># N: number of Bootstrap</span>
  
  <span class="cf">if</span>(true<span class="op">==</span><span class="st">&quot;empirical&quot;</span>) true=<span class="st">&quot;p_empirical&quot;</span>
  <span class="cf">if</span>(true<span class="op">==</span><span class="st">&quot;observed&quot;</span>) true=<span class="st">&quot;p_observed&quot;</span>
  
  <span class="co"># extract the &quot;true&quot; penetrance</span>
  true.p &lt;-<span class="st"> </span>d[d<span class="op">$</span>var<span class="op">==</span>var,true]
  
  <span class="co"># generate binomial data </span>
  event &lt;-<span class="st"> </span><span class="kw">rbinom</span>(N,n,true.p)
  
  <span class="co"># get the posterior credible interval</span>
  alpha &lt;-<span class="st"> </span>d<span class="op">$</span>alpha_g[<span class="kw">which</span>(d<span class="op">$</span>var<span class="op">==</span>var)] 
  beta &lt;-<span class="st"> </span>d<span class="op">$</span>beta_g[<span class="kw">which</span>(d<span class="op">$</span>var<span class="op">==</span>var)] 
  
  new.alpha &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>event
  new.beta &lt;-<span class="st"> </span>beta <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>event
  
  lb &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.025</span>,new.alpha,new.beta)
  ub &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.975</span>,new.alpha,new.beta)
  
  <span class="co"># change lb to floor of nearest 0.01</span>
  lb &lt;-<span class="st"> </span><span class="kw">floor</span>(lb<span class="op">*</span><span class="dv">100</span>)<span class="op">/</span><span class="dv">100</span>
  
  <span class="kw">return</span>(<span class="kw">sum</span>(lb <span class="op">&lt;</span><span class="st"> </span>true.p <span class="op">&amp;</span><span class="st"> </span>ub <span class="op">&gt;</span><span class="st"> </span>true.p)<span class="op">/</span>N) 
}</code></pre></div>
<p><a href="#top">Back to top</a></p>
</div>
<div id="plot-coverage" class="section level3">
<h3>Plot coverage</h3>
<div id="empirical-penetrance-as-the-true-penetrance" class="section level4">
<h4>Empirical penetrance as the true penetrance</h4>
<p>The coverage plot where the empirical penetrance is the true penetrance and one hundred new observations are added is shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;CheckPoint_20.RData&quot;</span>)

########## when n = 100 ##########

results &lt;-<span class="st"> </span><span class="kw">sapply</span>(d<span class="op">$</span>var,<span class="cf">function</span>(x) <span class="kw">BootsCoverage</span>(x,<span class="dt">n=</span><span class="dv">100</span>,<span class="dt">true=</span><span class="st">&quot;empirical&quot;</span>) )

carriers.size &lt;-<span class="st"> </span><span class="kw">ifelse</span>(d<span class="op">$</span>total_carriers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>,<span class="dv">1</span>,<span class="kw">ifelse</span>(d<span class="op">$</span>total_carriers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">100</span>,<span class="dv">2</span>,<span class="kw">ifelse</span>(d<span class="op">$</span>total_carriers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1000</span>,<span class="dv">3</span>,<span class="kw">ifelse</span>(d<span class="op">$</span>total_carriers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>) )))

new.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Penetrance=</span>d<span class="op">$</span>p_empirical,<span class="dt">Coverage=</span>results,<span class="dt">Number=</span><span class="kw">log10</span>(d<span class="op">$</span>total_carriers))

<span class="kw">ggplot</span>(<span class="dt">data=</span>new.data,<span class="kw">aes</span>(<span class="dt">x=</span>Penetrance,<span class="dt">y=</span>Coverage))<span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size=</span>Number,<span class="dt">color=</span>Number),<span class="dt">shape=</span><span class="dv">20</span>)<span class="op">+</span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.95</span>,<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot; True penetrance under simulation&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Coverage rate&quot;</span>, <span class="dt">size=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>),<span class="dt">color=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,<span class="dt">legend.box =</span> <span class="st">'vertical'</span>,<span class="dt">legend.justification =</span> <span class="st">'left'</span>,<span class="dt">legend.box.just =</span> <span class="st">'left'</span>,<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>))<span class="op">+</span><span class="kw">scale_colour_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;black&quot;</span>)</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_001.png' %}" width="672" /></p>
</div>
<div id="observed-penetrance-as-the-true-penetrance" class="section level4">
<h4>Observed penetrance as the true penetrance</h4>
<p>The coverage plot where the observed penetrance is the true penetrance and one hundred new observations are added is shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">########## when n = 100 ##########

results &lt;-<span class="st"> </span><span class="kw">sapply</span>(d<span class="op">$</span>var,<span class="cf">function</span>(x) <span class="kw">BootsCoverage</span>(x,<span class="dt">n=</span><span class="dv">100</span>,<span class="dt">true=</span><span class="st">&quot;observed&quot;</span>) )

carriers.size &lt;-<span class="st"> </span><span class="kw">ifelse</span>(d<span class="op">$</span>total_carriers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>,<span class="dv">1</span>,<span class="kw">ifelse</span>(d<span class="op">$</span>total_carriers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">100</span>,<span class="dv">2</span>,<span class="kw">ifelse</span>(d<span class="op">$</span>total_carriers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1000</span>,<span class="dv">3</span>,<span class="kw">ifelse</span>(d<span class="op">$</span>total_carriers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>) )))

new.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Penetrance=</span>d<span class="op">$</span>p_observed,<span class="dt">Coverage=</span>results,<span class="dt">Number=</span><span class="kw">log10</span>(d<span class="op">$</span>total_carriers))

<span class="kw">ggplot</span>(<span class="dt">data=</span>new.data,<span class="kw">aes</span>(<span class="dt">x=</span>Penetrance,<span class="dt">y=</span>Coverage))<span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size=</span>Number,<span class="dt">color=</span>Number))<span class="op">+</span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.95</span>,<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot; True penetrance under simulation&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Coverage rate&quot;</span>, <span class="dt">size=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>),<span class="dt">color=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,<span class="dt">legend.box =</span> <span class="st">'vertical'</span>,<span class="dt">legend.justification =</span> <span class="st">'left'</span>,<span class="dt">legend.box.just =</span> <span class="st">'left'</span>,<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>))<span class="op">+</span><span class="kw">scale_colour_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;black&quot;</span>)</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_002.png' %}" width="672" /></p>
<p><a href="#top">Back to top</a></p>
</div>
</div>
</div>
<div id="part-2-output-bland-altman-plots" class="section level2">
<h2>Part 2 Output Bland-Altman plots</h2>
<div id="em-prior-and-em-posterior" class="section level3">
<h3>EM prior and EM posterior</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># EM prior and EM posterior</span>

prior.mean &lt;-<span class="st"> </span>d<span class="op">$</span>alpha_g<span class="op">/</span>(d<span class="op">$</span>alpha_g<span class="op">+</span>d<span class="op">$</span>beta_g)
posterior.mean &lt;-<span class="st"> </span>(d<span class="op">$</span>alpha_g <span class="op">+</span><span class="st"> </span>d<span class="op">$</span>brs1)<span class="op">/</span>(d<span class="op">$</span>alpha_g<span class="op">+</span>d<span class="op">$</span>beta_g<span class="op">+</span>d<span class="op">$</span>total_carriers)

ba.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Difference=</span>prior.mean<span class="op">-</span>posterior.mean, <span class="dt">Average=</span>(prior.mean<span class="op">+</span>posterior.mean)<span class="op">/</span><span class="dv">2</span>,<span class="dt">Size=</span><span class="kw">log10</span>(d<span class="op">$</span>total_carriers))


<span class="kw">ggplot</span>(<span class="dt">data=</span>ba.data,<span class="kw">aes</span>(<span class="dt">x=</span>Average,<span class="dt">y=</span>Difference))<span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size=</span>Size,<span class="dt">color=</span>Size))<span class="op">+</span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.6</span>,<span class="fl">0.6</span>),<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.6</span>,<span class="fl">0.6</span>,<span class="dt">length=</span><span class="dv">9</span>))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Average of EM prior penetrance and EM posterior penetrance&quot;</span>,<span class="dt">y=</span><span class="st">&quot;EM prior penetrance- EM posterior penetrance&quot;</span>,<span class="dt">size=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>),<span class="dt">color=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,<span class="dt">legend.box =</span> <span class="st">'vertical'</span>,<span class="dt">legend.justification =</span> <span class="st">'left'</span>,<span class="dt">legend.box.just =</span> <span class="st">'left'</span>,<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="op">+</span><span class="kw">scale_colour_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;black&quot;</span>)</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_003.png' %}" width="672" /></p>
</div>
<div id="em-prior-and-empirical-posterior" class="section level3">
<h3>EM prior and empirical posterior</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># EM prior and empirical posterior</span>

prior.mean &lt;-<span class="st"> </span>d<span class="op">$</span>alpha_g<span class="op">/</span>(d<span class="op">$</span>alpha_g<span class="op">+</span>d<span class="op">$</span>beta_g)
posterior.mean &lt;-<span class="st"> </span>(<span class="fl">0.4492651</span> <span class="op">+</span><span class="st"> </span>d<span class="op">$</span>brs1)<span class="op">/</span>(<span class="fl">0.4492651</span><span class="op">+</span><span class="fl">2.727777</span><span class="op">+</span>d<span class="op">$</span>total_carriers)

ba.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Difference=</span>prior.mean<span class="op">-</span>posterior.mean, <span class="dt">Average=</span>(prior.mean<span class="op">+</span>posterior.mean)<span class="op">/</span><span class="dv">2</span>,<span class="dt">Size=</span><span class="kw">log10</span>(d<span class="op">$</span>total_carriers))

<span class="kw">ggplot</span>(<span class="dt">data=</span>ba.data,<span class="kw">aes</span>(<span class="dt">x=</span>Average,<span class="dt">y=</span>Difference))<span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size=</span>Size,<span class="dt">color=</span>Size))<span class="op">+</span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.6</span>,<span class="fl">0.6</span>),<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.6</span>,<span class="fl">0.6</span>,<span class="dt">length=</span><span class="dv">9</span>))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Average of EM prior penetrance and empirical posterior penetrance&quot;</span>,<span class="dt">y=</span><span class="st">&quot;EM prior penetrance- Empirical posterior penetrance&quot;</span>,<span class="dt">size=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>),<span class="dt">color=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,<span class="dt">legend.box =</span> <span class="st">'vertical'</span>,<span class="dt">legend.justification =</span> <span class="st">'left'</span>,<span class="dt">legend.box.just =</span> <span class="st">'left'</span>,<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="op">+</span><span class="kw">scale_colour_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_colorbar</span>(<span class="dt">order =</span> <span class="dv">1</span>),
         <span class="dt">size =</span> <span class="kw">guide_legend</span>(<span class="dt">order =</span> <span class="dv">2</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_004.png' %}" width="672" /></p>
</div>
<div id="em-posterior-and-empirical-posterior" class="section level3">
<h3>EM posterior and empirical posterior</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># EM posterior and empirical posterior</span>

prior.mean &lt;-<span class="st"> </span>(d<span class="op">$</span>alpha_g <span class="op">+</span><span class="st"> </span>d<span class="op">$</span>brs1)<span class="op">/</span>(d<span class="op">$</span>alpha_g<span class="op">+</span>d<span class="op">$</span>beta_g<span class="op">+</span>d<span class="op">$</span>total_carriers)
posterior.mean &lt;-<span class="st"> </span>(<span class="fl">0.4492651</span> <span class="op">+</span><span class="st"> </span>d<span class="op">$</span>brs1)<span class="op">/</span>(<span class="fl">0.4492651</span><span class="op">+</span><span class="fl">2.727777</span><span class="op">+</span>d<span class="op">$</span>total_carriers)

ba.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Difference=</span>prior.mean<span class="op">-</span>posterior.mean, <span class="dt">Average=</span>(prior.mean<span class="op">+</span>posterior.mean)<span class="op">/</span><span class="dv">2</span>,<span class="dt">Size=</span><span class="kw">log10</span>(d<span class="op">$</span>total_carriers))

<span class="kw">ggplot</span>(<span class="dt">data=</span>ba.data,<span class="kw">aes</span>(<span class="dt">x=</span>Average,<span class="dt">y=</span>Difference))<span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size=</span>Size,<span class="dt">color=</span>Size))<span class="op">+</span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.6</span>,<span class="fl">0.6</span>),<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.6</span>,<span class="fl">0.6</span>,<span class="dt">length=</span><span class="dv">9</span>))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Average of EM posterior penetrance and empirical posterior penetrance&quot;</span>,<span class="dt">y=</span><span class="st">&quot;EM posterior penetrance- Empirical posterior penetrance&quot;</span>,<span class="dt">size=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>),<span class="dt">color=</span><span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">log_{10}$(Total number of carriers)&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,<span class="dt">legend.box =</span> <span class="st">'vertical'</span>,<span class="dt">legend.justification =</span> <span class="st">'left'</span>,<span class="dt">legend.box.just =</span> <span class="st">'left'</span>,<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="op">+</span><span class="kw">scale_colour_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;black&quot;</span>)</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_005.png' %}" width="672" /></p>
<p><a href="#top">Back to top</a></p>
</div>
</div>
<div id="part-3-forest-plots" class="section level2">
<h2>Part 3 Forest plots</h2>
<p>The code to produce the forest plots is shown in the code chunk.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(d)

<span class="kw">load</span>(<span class="st">&quot;CheckPoint_20.RData&quot;</span>)

new_mean &lt;-<span class="st"> </span>(d<span class="op">$</span>alpha_g <span class="op">+</span><span class="st"> </span>d<span class="op">$</span>brs1)<span class="op">/</span>(d<span class="op">$</span>alpha_g<span class="op">+</span>d<span class="op">$</span>beta_g<span class="op">+</span>d<span class="op">$</span>total_carriers)
alt.mean &lt;-<span class="st"> </span>(<span class="fl">0.4492651</span> <span class="op">+</span><span class="st"> </span>d<span class="op">$</span>brs1)<span class="op">/</span>(<span class="fl">0.4492651</span><span class="op">+</span><span class="fl">2.727777</span><span class="op">+</span>d<span class="op">$</span>total_carriers)

lower &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.025</span>,d<span class="op">$</span>alpha_g,d<span class="op">$</span>beta_g)
higher &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.975</span>,d<span class="op">$</span>alpha_g,d<span class="op">$</span>beta_g) 

forest.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">variant =</span> d<span class="op">$</span>var, <span class="dt">em.posterior =</span> new_mean, <span class="dt">empirical.posterior=</span>alt.mean,
                          <span class="dt">lower=</span>lower, <span class="dt">higher=</span>higher,<span class="dt">total.carriers=</span>d<span class="op">$</span>total_carriers, <span class="dt">brs1=</span>d<span class="op">$</span>brs1, <span class="dt">resnum=</span>d<span class="op">$</span>resnum)

forest.data &lt;-<span class="st"> </span>forest.data[<span class="kw">order</span>(forest.data<span class="op">$</span>resnum,forest.data<span class="op">$</span>total.carriers),]

<span class="kw">head</span>(forest.data)

plotf &lt;-<span class="st"> </span><span class="cf">function</span>(a,b){
  <span class="kw">png</span>( <span class="kw">paste</span>(<span class="st">&quot;Plots/Forest Plots/&quot;</span>, a, <span class="st">&quot;-&quot;</span>,b,<span class="st">&quot;pics.png&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">res=</span><span class="dv">300</span>,<span class="dt">height=</span><span class="dv">10</span>,<span class="dt">width=</span><span class="dv">10</span>,<span class="dt">units=</span><span class="st">&quot;in&quot;</span>)
  <span class="kw">forestplot</span>(<span class="kw">paste</span>(forest.data[a<span class="op">:</span>b,<span class="st">&quot;variant&quot;</span>], <span class="st">&quot; &quot;</span>, forest.data<span class="op">$</span>brs1[a<span class="op">:</span>b], <span class="st">&quot;/&quot;</span>, forest.data<span class="op">$</span>total.carriers[a<span class="op">:</span>b]), 
           <span class="dt">fn.ci_norm =</span> fpDrawNormalCI,
           <span class="dt">boxsize =</span> .<span class="dv">25</span>, <span class="co"># We set the box size to better visualize the type</span>
           <span class="dt">line.margin =</span> .<span class="dv">1</span>, <span class="co"># We need to add this to avoid crowding</span>
           <span class="dt">mean =</span> <span class="kw">cbind</span>(forest.data[a<span class="op">:</span>b,<span class="st">&quot;em.posterior&quot;</span>]),
           <span class="dt">lower =</span> <span class="kw">cbind</span>(forest.data[a<span class="op">:</span>b,<span class="st">&quot;lower&quot;</span>]),
           <span class="dt">upper =</span> <span class="kw">cbind</span>(forest.data[a<span class="op">:</span>b,<span class="st">&quot;higher&quot;</span>]),
           <span class="dt">xticks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),
           <span class="dt">col=</span><span class="kw">fpColors</span>(<span class="dt">box=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">line=</span><span class="st">&quot;red&quot;</span>),
           <span class="dt">xlab=</span><span class="st">&quot;Number line&quot;</span>)
  <span class="kw">dev.off</span>()
  
}

<span class="kw">sapply</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">27</span><span class="op">*</span><span class="dv">50</span><span class="op">+</span><span class="dv">1</span>,<span class="cf">function</span>(x) <span class="kw">plotf</span>(x,x<span class="op">+</span><span class="dv">49</span>) )
<span class="kw">plotf</span>(<span class="dv">1401</span>,<span class="dv">1439</span>)</code></pre></div>
<p>The forests plots are pasted below, where blue boxes are EM posteriors, and red segements are EM priors. Variant name is followed by number of Brs1 cases / total number of heterozygotes.</p>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_006.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_007.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_008.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_009.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_010.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_011.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_012.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_013.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_014.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_015.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_016.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_017.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_018.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_019.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_020.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_021.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_022.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_023.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_024.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_025.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_026.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_027.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_028.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_029.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_030.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_031.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_032.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_033.png' %}" />

</div>
<div class="figure">
<img src="{% static 'images/penetrance_scn5a/img_034.png' %}" />

</div>
<p><a href="#top">Back to top</a></p>
</div>
<div id="part-4-correlation-coefficients-and-plots" class="section level2">
<h2>Part 4 Correlation Coefficients and Plots</h2>
<p>The code to produce the weighted correlations is shown in the code chunk. The size of the circles in the presented figures are scaled by the Log<sub>10</sub>(Total Number of Carriers).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(d)
<span class="kw">library</span>(boot)</code></pre></div>
<pre><code>## Warning: package 'boot' was built under R version 3.6.3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(wCorr)</code></pre></div>
<pre><code>## Warning: package 'wCorr' was built under R version 3.6.3</code></pre>
<pre><code>## wCorr v1.9.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;CheckPoint_20.RData&quot;</span>)
d&lt;-d[,<span class="op">!</span>(<span class="kw">names</span>(d) <span class="op">%in%</span><span class="st"> &quot;aaneigh_rank_inc_loops&quot;</span>)]

plt.disease &lt;-<span class="st"> </span><span class="cf">function</span>(d, func, funcName, disName, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">200</span>), <span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">variant=</span><span class="st">&quot;NA&quot;</span>, <span class="dt">sp=</span><span class="fl">0.7</span>){
  <span class="kw">par</span>(<span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">bty=</span><span class="st">'l'</span>, <span class="dt">lwd=</span><span class="dv">2</span>)
  <span class="cf">if</span> (disName<span class="op">==</span><span class="st">&quot;BrS_penetranceBayesian&quot;</span>){dis=<span class="st">&quot;BrS1&quot;</span>; pcolor=<span class="st">&quot;gray&quot;</span>}
  <span class="cf">else</span> <span class="cf">if</span>(disName<span class="op">==</span><span class="st">&quot;BrS_penetranceBayesian_initial&quot;</span>){dis=<span class="st">&quot;BrS1&quot;</span>; pcolor=<span class="st">&quot;gray&quot;</span>} 
  <span class="cf">else</span> <span class="cf">if</span> (disName<span class="op">==</span><span class="st">&quot;all_penetranceBayesian&quot;</span>){dis=<span class="st">&quot;BrS1 and LQT3&quot;</span>; pcolor=<span class="st">&quot;gray&quot;</span>}
  <span class="kw">plot</span>(d[,func], (d[,disName]), <span class="dt">pch=</span><span class="dv">21</span>,
     <span class="dt">bg=</span>pcolor, <span class="dt">cex=</span><span class="kw">log</span>(d[,<span class="st">&quot;total_carriers&quot;</span>])<span class="op">+</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="fl">1.5</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, 
     <span class="dt">cex.lab=</span><span class="fl">1.5</span>, <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;Penetrance (%&quot;</span>,dis,<span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="dt">xlab =</span> funcName,
     <span class="dt">ylim =</span> yl, <span class="dt">xlim =</span> xl)
  
  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">cex.axis=</span><span class="fl">1.5</span>)
  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">cex.axis=</span><span class="fl">1.5</span>)
  <span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)

  <span class="cf">if</span> (variant<span class="op">!=</span><span class="st">&quot;NA&quot;</span>){
  <span class="kw">points</span>(d[d<span class="op">$</span>var<span class="op">==</span>variant,func], <span class="dv">100</span><span class="op">*</span>(d[d<span class="op">$</span>var<span class="op">==</span>variant,disName]), <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">cex=</span><span class="kw">log</span>(d[d<span class="op">$</span>var<span class="op">==</span>variant,<span class="st">&quot;total_carriers&quot;</span>])<span class="op">+</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;red&quot;</span>)
  }
}

d<span class="op">$</span>BrS_penetranceBayesian&lt;-(d<span class="op">$</span>alpha_g<span class="op">+</span>d<span class="op">$</span>brs1)<span class="op">/</span>(d<span class="op">$</span>alpha_g<span class="op">+</span>d<span class="op">$</span>beta_g<span class="op">+</span>d<span class="op">$</span>total_carriers)
filt&lt;-<span class="dv">0</span>
fglm&lt;-d[d<span class="op">$</span>total_carriers<span class="op">&gt;</span>filt <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>blastpssm) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>ipeak) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>feat_dist_w), ]</code></pre></div>
<div id="expectation-maximization" class="section level3">
<h3>Expectation Maximization</h3>
<p>The following figures and calculations compare EM priors (predicted) with EM posteriors (penetrance or “truth”)</p>
<div id="peak-current-covariate-alone" class="section level4">
<h4>Peak Current Covariate Alone</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian <span class="op">~</span><span class="st"> </span>ipeak, fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.ipeak&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.ipeak&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_035.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.418041, 95% Confidence Interval: [0.3306308 - 0.5073953], AIC: 24.6227601</p>
</div>
<div id="penetrance-density-covariate-alone" class="section level4">
<h4>Penetrance Density Covariate Alone</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian <span class="op">~</span><span class="st"> </span>feat_dist_w, fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.feat_dist&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.feat_dist&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_036.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.6636861, 95% Confidence Interval: [0.5627574 - 0.7490082], AIC: -138.2387088</p>
</div>
<div id="peak-current-and-penetrance-density-covariates" class="section level4">
<h4>Peak Current and Penetrance Density Covariates</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian<span class="op">~</span>ipeak<span class="op">+</span>feat_dist_w,fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.ipeak.dist&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.ipeak.dist&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_037.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.7794271, 95% Confidence Interval: [0.7139909 - 0.8336107], AIC: -261.5181923</p>
</div>
<div id="in-silico-peak-current-and-penetrance-density-covariates" class="section level4">
<h4>In Silico, Peak Current, and Penetrance Density Covariates</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian<span class="op">~</span>ipeak<span class="op">+</span>feat_dist_w<span class="op">+</span>eaRate<span class="op">+</span>blastpssm<span class="op">+</span>provean_score<span class="op">+</span>pph2_prob,fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.all.comps.ipeak&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.all.comps.ipeak&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_038.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.8028511, 95% Confidence Interval: [0.7404891 - 0.8547397], AIC: -286.8621177</p>
</div>
<div id="in-silico-covariates-alone" class="section level4">
<h4>In Silico Covariates Alone</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian<span class="op">~</span>eaRate<span class="op">+</span>blastpssm<span class="op">+</span>provean_score<span class="op">+</span>pph2_prob,fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.all.comps&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.all.comps&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_039.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.2303246, 95% Confidence Interval: [0.158621 - 0.3058438], AIC: 113.65471</p>
</div>
</div>
<div id="empirical-bayes" class="section level3">
<h3>Empirical Bayes</h3>
<p>The code to produce the weighted correlations is shown in the code chunk. The size of the circles in the presented figures are scaled by the Log<sub>10</sub>(Total Number of Carriers). The following figures and calculations compare EM priors (predicted) with <em>Empirical</em> posteriors (penetrance or “truth”)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d<span class="op">$</span>BrS_penetranceBayesian_initial&lt;-(alpha_0_w<span class="op">+</span>d<span class="op">$</span>brs1)<span class="op">/</span>(alpha_0_w<span class="op">+</span>beta_0_w<span class="op">+</span>d<span class="op">$</span>total_carriers)
filt&lt;-<span class="dv">0</span>
fglm&lt;-d[d<span class="op">$</span>total_carriers<span class="op">&gt;</span>filt <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>blastpssm) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>ipeak) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(d<span class="op">$</span>feat_dist_w), ]

model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian_initial <span class="op">~</span><span class="st"> </span>ipeak, fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.ipeak&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.ipeak&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian_initial&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_040.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian_initial,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian_initial[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.2858094, 95% Confidence Interval: [0.1987912 - 0.3816886], AIC: 208.7755596</p>
<div id="penetrance-density-covariate-alone-1" class="section level4">
<h4>Penetrance Density Covariate Alone</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian_initial <span class="op">~</span><span class="st"> </span>feat_dist_w, fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.feat_dist&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.feat_dist&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian_initial&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_041.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian_initial,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian_initial[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.3551989, 95% Confidence Interval: [0.2364116 - 0.4729206], AIC: 178.4198057</p>
</div>
<div id="peak-current-and-penetrance-density-covariates-1" class="section level4">
<h4>Peak Current and Penetrance Density Covariates</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian_initial<span class="op">~</span>ipeak<span class="op">+</span>feat_dist_w,fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.ipeak.dist&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.ipeak.dist&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian_initial&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_042.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian_initial,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian_initial[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.4553999, 95% Confidence Interval: [0.3468385 - 0.551581], AIC: 130.2594454</p>
</div>
<div id="peak-current-and-penetrance-density-covariates-2" class="section level4">
<h4>Peak Current and Penetrance Density Covariates</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian_initial<span class="op">~</span>ipeak<span class="op">+</span>feat_dist_w<span class="op">+</span>eaRate<span class="op">+</span>blastpssm<span class="op">+</span>provean_score<span class="op">+</span>pph2_prob,fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.all.comps.ipeak&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.all.comps.ipeak&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian_initial&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_043.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="st">&quot;In Silico, Peak Current, and Penetrance Density Covariates&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;In Silico, Peak Current, and Penetrance Density Covariates&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian_initial,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian_initial[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.4668705, 95% Confidence Interval: [0.3615724 - 0.5811996], AIC: 131.9370815</p>
</div>
<div id="in-silico-covariates-alone-1" class="section level4">
<h4>In Silico Covariates Alone</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(BrS_penetranceBayesian_initial<span class="op">~</span>eaRate<span class="op">+</span>blastpssm<span class="op">+</span>provean_score<span class="op">+</span>pph2_prob,fglm, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>fglm<span class="op">$</span>p_variance_w)
fglm<span class="op">$</span>pred.all.comps&lt;-<span class="kw">predict</span>(model, fglm, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">plt.disease</span>(fglm, <span class="st">&quot;pred.all.comps&quot;</span>, <span class="st">&quot;Predicted Penetrance&quot;</span>, <span class="st">&quot;BrS_penetranceBayesian_initial&quot;</span>, <span class="dt">xl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>),<span class="dt">yl=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.9</span>))</code></pre></div>
<p><img src="{% static 'images/penetrance_scn5a/img_044.png' %}" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod&lt;-<span class="kw">data.frame</span>(model<span class="op">$</span>fitted.values,model<span class="op">$</span>model<span class="op">$</span>BrS_penetranceBayesian_initial,model<span class="op">$</span>weights)
foo &lt;-<span class="st"> </span><span class="kw">boot</span>(mod, <span class="cf">function</span>(data,indices)
  <span class="kw">weightedCorr</span>(mod<span class="op">$</span>model.fitted.values[indices],mod<span class="op">$</span>model.model.BrS_penetranceBayesian_initial[indices], <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">weights =</span> mod<span class="op">$</span>model.weights[indices])<span class="op">^</span><span class="dv">2</span>, <span class="dt">R=</span><span class="dv">1000</span>)</code></pre></div>
<p>Weighted R2: 0.1377443, 95% Confidence Interval: [0.0764987 - 0.2127126], AIC: 270.7309733</p>
</div>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

{% endblock %}